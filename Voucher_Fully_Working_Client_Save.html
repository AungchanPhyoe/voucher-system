<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Installation Voucher - Than Htike & Brothers</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}body{font-family:'Roboto',sans-serif;background:#e8ecef;padding:20px}.container{max-width:1000px;margin:0 auto}.voucher-form,.search-form,.voucher-list,.client-form{background:white;padding:20px;border-radius:10px;box-shadow:0 4px 8px rgba(0,0,0,0.1);margin-bottom:20px}.form-group{margin-bottom:15px}label{display:block;margin-bottom:5px;font-weight:bold}input,select,textarea{width:100%;padding:8px;border:1px solid #ddd;border-radius:5px}textarea{resize:vertical}.items-table{width:100%;border-collapse:collapse;margin:15px 0}.items-table th,.items-table td{border:1px solid #ddd;padding:8px;text-align:left}.items-table th{background-color:#ffd700;color:#333}.item-row input{width:90%;padding:5px}button{background-color:#ff4500;color:white;border:none;padding:10px 20px;border-radius:5px;cursor:pointer;margin-right:10px}button:hover{background-color:#e03e00}.task-bar{margin-top:10px}.voucher{width:595px;background:#fff;border:2px solid #ffd700;border-radius:10px;box-shadow:0 4px 8px rgba(0,0,0,0.2);padding:20px;text-align:center;margin:20px auto}.title-container{position:relative;display:flex;align-items:center;justify-content:center}.title{font-family:'Poppins',sans-serif;font-size:32px;font-weight:700;color:#ff4500;text-shadow:1px 1px 2px rgba(0,0,0,0.3);margin:10px 0;text-transform:uppercase;letter-spacing:0.5px}.logo{max-width:120px;margin-right:10px}.circuit-bg{position:absolute;top:-10px;left:-20px;width:120%;height:120%;z-index:0;opacity:0.2}.circuit-bg svg{width:100%;height:100%}.circuit-bg path{stroke:#ffd700;stroke-width:2;fill:none;animation:circuitFlow 5s infinite linear}.details{font-size:16px;color:#666;margin:10px 0}.phone{font-size:18px;color:#ff4500;font-weight:bold}.border{border-top:2px dashed #ff4500;margin:20px 0}.footer p{margin:5px 0;font-size:14px;color:#333}.footer i{color:#ff4500;margin-right:8px}.customer-info-left{text-align:left;margin-bottom:10px}.customer-info-left label{display:flex;align-items:center;font-weight:bold;color:#333}.customer-info-left span{margin-left:5px;color:#666}.additional-info{margin:15px 0;font-size:14px;color:#666}.additional-info .row{display:flex;justify-content:space-between;align-items:center;margin-bottom:5px}.additional-info label{display:flex;align-items:center;font-weight:bold;color:#333}.additional-info span{margin-left:5px;color:#ff4500}.table-container{margin:20px 0}.voucher table{width:100%;border-collapse:collapse;font-size:14px}.voucher th,.voucher td{border:1px solid #ffd700;padding:8px}.voucher th{background:#ffd700;color:#333;font-weight:bold;text-align:center}.voucher td{color:#333}.voucher td:nth-child(6){text-align:right}.total-section{margin-top:10px;text-align:right}.total-section div{margin:5px 0}.total{font-size:18px;font-weight:bold;color:#ff4500}.subtotal,.discount{font-size:16px;color:#333}.signature-section{margin-top:20px;display:flex;justify-content:space-between}.signature-box{width:45%;text-align:center}.signature-box p{font-size:14px;color:#333;margin-bottom:10px}.signature-line{border-bottom:1px solid #333;width:100%;margin-top:20px}.voucher-list ul,.client-form ul{list-style:none;padding:0}.voucher-list li,.client-form li{padding:10px;border-bottom:1px solid #ddd;cursor:pointer;display:flex;justify-content:space-between;align-items:center}.voucher-list li:hover,.client-form li:hover{background:#f5f5f5}.voucher-list li button,.client-form li button{padding:5px 10px;font-size:12px}.voucher-details{flex:1;text-align:left}.loading{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.7);color:white;padding:20px;border-radius:5px;display:none}.modal{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:white;padding:20px;border-radius:10px;box-shadow:0 4px 8px rgba(0,0,0,0.2);display:none;z-index:1000}.modal button{background:#ff4500;color:white;border:none;padding:5px 10px;cursor:pointer}@keyframes circuitFlow{0%{stroke-dasharray:10,10;stroke-dashoffset:0}50%{stroke-dashoffset:-20}100%{stroke-dashoffset:-40}}
        @media print {
            .voucher-form, .search-form, .voucher-list, .client-form, .task-bar, .loading, .modal, button[onclick="saveVoucher()"] {
                display: none !important;
            }
            .voucher {
                display: block !important;
                box-shadow: none;
                width: 100%;
                border: none;
                margin: 0;
                padding: 10px;
            }
            .circuit-bg {
                display: none;
            }
            body, .container {
                margin: 0;
                padding: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="loading" class="loading">Processing...</div>
        <div id="modal" class="modal"><p id="modalMessage"></p><button onclick="closeModal()">OK</button></div>
        <div class="client-form" id="clientFormSection">
            <h3>Add New Client</h3>
            <div class="form-group"><label>Client Name</label><input type="text" id="newClientName" placeholder="Enter client name"></div>
            <div class="form-group"><label>Address</label><input type="text" id="newClientAddress" placeholder="Enter address"></div>
            <button onclick="addClient()">Add Client</button>
            <button onclick="toggleClientList()">Client List</button>
            <ul id="clientList" style="display:none;"></ul>
        </div>
        <div class="voucher-form">
            <div class="form-group"><label>Client Name</label><select id="clientName" onchange="updateClientAddress()"><option value="">Select a client</option></select></div>
            <div class="form-group"><label>Address</label><input type="text" id="clientAddress" placeholder="Address will auto-fill"></div>
            <div class="form-group"><label>Date</label><input type="date" id="date"></div>
            <div class="form-group"><label>Project Reference</label><input type="text" id="projectRef" placeholder="e.g., Project #123"></div>
            <table class="items-table">
                <thead><tr><th>No</th><th>Type</th><th>Description</th><th>Qty</th><th>Unit</th><th>Rate</th><th>Amount</th><th>Action</th></tr></thead>
                <tbody id="itemsBody">
                    <tr class="item-row">
                        <td><input type="number" class="item-no" value="1" readonly></td>
                        <td><select class="item-type"><option value="Material">Material</option><option value="Service">Service</option></select></td>
                        <td><input type="text" class="item-name" placeholder="Description (e.g., Wiring, Labor)"></td>
                        <td><input type="number" class="item-qty" min="1" value="1"></td>
                        <td><input type="text" class="item-unit" placeholder="Unit (e.g., ft, hrs)" value="pcs"></td>
                        <td><input type="number" class="item-rate" min="0" placeholder="0"></td>
                        <td><input type="number" class="item-amount" readonly value="0"></td>
                        <td><button onclick="removeItem(this)">Remove</button></td>
                    </tr>
                </tbody>
            </table>
            <div class="form-group"><label>Discount</label><input type="number" id="discount" min="0" value="0" placeholder="Enter discount amount"></div>
            <div class="form-group"><label>Note</label><textarea id="note" placeholder="Additional notes"></textarea></div>
            <button onclick="addNewItem()">Add Item</button>
            <div class="task-bar">
                <button onclick="saveVoucher()">Save Voucher</button>
                <button onclick="generateVoucher()">Generate Voucher</button>
                <button onclick="printVoucher()">Print Voucher</button>
                <button onclick="exportToPDF()">Export to PDF</button>
                <button onclick="exportData()">Export Data</button>
                <input type="file" id="importFile" style="display:none;" onchange="importData(event)">
                <button onclick="document.getElementById('importFile').click()">Import Data</button>
                <button onclick="toggleVoucherList()">Voucher List</button>
                <select onchange="switchLanguage(this.value)"><option value="en">English</option><option value="my">မြန်မာ</option></select>
            </div>
        </div>
        <div class="search-form">
            <div class="form-group"><label>Search by Voucher ID or Client Name</label><input type="text" id="searchInput" placeholder="Enter Voucher ID (e.g., THB-123456) or Client Name"></div>
            <button onclick="searchVoucher()">Search</button>
        </div>
        <div class="voucher-list" id="voucherListSection" style="display:none;">
            <h3>Saved Vouchers</h3>
            <ul id="voucherList"></ul>
        </div>
        <div class="voucher" id="voucher" style="display:none;">
            <div class="title-container">
                <img src="https://i.imgur.com/BKR4AHW.png" alt="Than Htike & Brothers Logo" class="logo">
                <div class="title">Than Htike & Brothers</div>
                <div class="circuit-bg">
                    <svg viewBox="0 0 200 100">
                        <path d="M10 10 H 190 M10 20 H 100 M120 20 H 190 M10 30 H 80 M100 30 H 190 M10 40 H 60 M80 40 H 190 M10 50 H 40 M60 50 H 190 M10 60 H 20 M40 60 H 190 M10 70 H 190" />
                    </svg>
                </div>
            </div>
            <div class="details">Electrical Installation Services</div>
            <div class="phone">09420716702 | 09440849859</div>
            <div class="customer-info-left">
                <label>Name: <span id="vName">-</span></label>
                <label>Address: <span id="vAddress">-</span></label>
            </div>
            <div class="additional-info">
                <div class="row">
                    <label>Project Reference: <span id="vProjectRef">-</span></label>
                    <label>Voucher ID: <span id="vVoucherId">-</span></label>
                </div>
                <div class="row">
                    <label>Note: <span id="vNote">-</span></label>
                    <label>Date: <span id="vDate">-</span></label>
                </div>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>No</th>
                            <th>Type</th>
                            <th>Description</th>
                            <th>Qty</th>
                            <th>Unit</th>
                            <th>Rate</th>
                            <th>Amount</th>
                        </tr>
                    </thead>
                    <tbody id="voucherItemsBody"></tbody>
                </table>
                <div class="total-section">
                    <div class="subtotal" id="voucherSubtotal">Subtotal: 0</div>
                    <div class="discount" id="voucherDiscount">Discount: 0</div>
                    <div class="total" id="voucherTotal">Grand Total: 0</div>
                </div>
            </div>
            <div class="border"></div>
            <div class="footer">
                <p><i class="fas fa-envelope"></i> aungchanphyo2014@gmail.com | <i class="fas fa-phone"></i> 09420716702 - 09440849859</p>
                <p><i class="fas fa-tools"></i> Professional Electrical Installation & Maintenance Services</p>
                <p>Thank you for trusting Than Htike & Brothers - Your Reliable Electrical Partner</p>
            </div>
            <div class="signature-section">
                <div class="signature-box">
                    <p>Authorized Signature (Than Htike & Brothers)</p>
                    <div class="signature-line"></div>
                </div>
                <div class="signature-box">
                    <p>Client Signature</p>
                    <div class="signature-line"></div>
                </div>
            </div>
        </div>
    </div>
    

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwULv9hL1ZIrthMJ7b93M62OAWy7XrD7DgihUAzPtgcOEfcqCkDp5rcZj0HNc0Hbcqx/exec";

function showModal(message) {
    alert(message);
}

function showLoading() {
    console.log('Loading...');
}

function hideLoading() {
    console.log('Done.');
}

function addClient() {
    const clientName = document.getElementById('newClientName').value.trim();
    const clientAddress = document.getElementById('newClientAddress').value.trim();
    if (!clientName || !clientAddress) {
        showModal('Please enter both Client Name and Address');
        return;
    }
    showLoading();
    fetch(SCRIPT_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            type: 'client',
            name: clientName,
            address: clientAddress
        })
    })
    .then(res => res.json())
    .then(response => {
        showModal('✅ ' + response.message);
        document.getElementById('newClientName').value = '';
        document.getElementById('newClientAddress').value = '';
        loadClients();
    })
    .catch(error => {
        showModal('❌ Failed to save client: ' + error.message);
    })
    .finally(() => {
        hideLoading();
    });
}

function loadClients() {
    fetch(SCRIPT_URL + "?type=client")
        .then(res => res.json())
        .then(clients => {
            const clientSelect = document.getElementById('clientName');
            if (!clientSelect) return;
            clientSelect.innerHTML = '<option value="">Select a client</option>';
            clients.forEach(client => {
                const option = document.createElement('option');
                option.value = client.name;
                option.textContent = client.name;
                clientSelect.appendChild(option);
            });
        })
        .catch(err => console.error('Client load error:', err));
}

window.onload = () => {
    loadClients();
}
</script>

</body>
</html>